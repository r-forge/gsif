<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Supervised fuzzy _k_-means on spatial pixels</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">
</head><body>

<table width="100%" summary="page for spfkm {GSIF}"><tr><td>spfkm {GSIF}</td><td align="right">R Documentation</td></tr></table>

<h2>Supervised fuzzy <EM>k</EM>-means on spatial pixels</h2>

<h3>Description</h3>

<p>Runs supervised fuzzy <EM>k</EM>-means using a list of covariates layers provided as <code>"SpatialPixelsDataFrame"</code>. If class centres and variances are not provided by the users, it first fits a multinomial logistic regression model (<code>spmultinom</code>) using the point data and a regression matrix, then predicts the class centres and variances based on the output from the <code>nnet::multinom</code>.</p>


<h3>Usage</h3>

<pre>
spfkm(formulaString, observations, covariates, ...)
</pre>


<h3>Arguments</h3>


<table summary="R argblock">
<tr valign="top"><td><code>formulaString</code></td>
<td>
<p>formula string</p>
</td></tr>
<tr valign="top"><td><code>observations</code></td>
<td>
<p>object of type <code>"SpatialPointsData"</code>; occurrences of factors</p>
</td></tr>
<tr valign="top"><td><code>covariates</code></td>
<td>
<p>object of type <code>"SpatialPixelsData"</code> or <code>"RasterBrick"</code>; list of covariate layers</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>optional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Optional arguments include:
</p>

<dl>
<dt>class.c</dt><dd><p>object of type <code>"matrix"</code>; class centres (see examples below)</p>
</dd>
<dt>class.sd</dt><dd><p>object of type <code>"matrix"</code>; class deviations (see examples below)</p>
</dd>
<dt>fuzzy.e</dt><dd><p>object of type <code>"numeric"</code>; fuzzy exponent</p>
</dd>
</dl>



<h3>Value</h3>

<p>Returns an object of type <code>"SpatialMemberships"</code> with following slots: <code>predicted</code> (classes predicted either by the multinomial logistic regression or fuzzy <EM>k</EM>-means), <code>model</code> (the multinomial logistic regression model; if available), <code>mu</code> (memberships derived using the fuzzy <EM>k</EM>-means), <code>class.c</code> (submitted or derived class centres), <code>class.sd</code> (submitted or derived class deviations), <code>confusion</code> (confusion matrix).</p>


<h3>Note</h3>

<p>Although <code>nnet::multinom</code> is consider to be robust and suited for large data sets, function might not converge in some cases or result in artifacts. If this happens try setting up the class centres and variances manually.</p>


<h3>Author(s)</h3>

<p>Tomislav Hengl</p>


<h3>References</h3>



<ul>
<li><p> Burrough, P. A., Gaans, P.F.M., and Van Hootsmans, R., (1997) <a href="http://dx.doi.org/10.1016/S0016-7061(97)00018-9">Continuous classification in soil survey: spatial correlation, confusion and boundaries</a>. Geoderma, 77(2-4), 115&ndash;135.
</p>
</li>
<li><p> Multinomial logistic regression (<a href="http://en.wikipedia.org/wiki/Multinomial_logit">http://en.wikipedia.org/wiki/Multinomial_logit</a>)
</p>
</li>
<li><p> Nnet package (<a href="http://CRAN.R-project.org/package=nnet">http://CRAN.R-project.org/package=nnet</a>)
</p>
</ul>



<h3>See Also</h3>

 <p><code>nnet::multinom</code>, <code><a href="SpatialMemberships-class.html">SpatialMemberships-class</a></code></p>


<h3>Examples</h3>

<pre>
## Not run: # load data:
library(plotKML)
data(eberg)
eberg &lt;- eberg[runif(nrow(eberg))&lt;.2,]
data(eberg_grid)
coordinates(eberg) &lt;- ~X+Y
proj4string(eberg) &lt;- CRS("+init=epsg:31467")
gridded(eberg_grid) &lt;- ~x+y
proj4string(eberg_grid) &lt;- CRS("+init=epsg:31467")
# derive soil predictive components:
eberg_spc &lt;- spc(eberg_grid, ~PRMGEO6+DEMSRT6+TWISRT6+TIRAST6)
# predict memberships:
formulaString = soiltype ~ PC1+PC2+PC3+PC4+PC5+PC6+PC7+PC8+PC9+PC10
eberg_sm &lt;- spfkm(formulaString, eberg, eberg_spc@predicted)
# plot memberships:
pal = seq(0, 1, 1/50)
spplot(eberg_sm@mu, col.regions=pal)
image(eberg_sm@mu[1], col=pal)
text(eberg@coords, paste(eberg$soiltype), cex=.6, col="black")
# classes predicted:
eberg_sm@predicted$soiltype &lt;- as.factor(eberg_sm@predicted$soiltype)
Ls = length(levels(eberg_sm@predicted$soiltype))
pnts = list("sp.points", eberg, pch="+", cex=.6, col="black")
spplot(eberg_sm@predicted, col.regions=rainbow(Ls)[rank(runif(Ls))], sp.layout=pnts)
spplot(eberg_sm@mu[2], at=pal, col.regions=rev(heat.colors(50)), sp.layout=pnts)

## End(Not run)
</pre>

<hr><div align="center">[Package <em>GSIF</em> version 0.2-1 <a href="00Index.html">Index</a>]</div>
</body></html>
